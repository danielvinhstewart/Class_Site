/*!
 * jQuery photoWall.js v1.0.0
 * http://jeremyjcpaul.com
 * https://github.com/jeremyjcpaul/photowall
 *
 * Copyright 2013 Jeremy JC Paul
 * Released under the MIT license.
 * https://github.com/jeremyjcpaul/photowall/blob/master/MIT-LICENSE.txt
 *
 * Date: 21/11/2013
 */
(function(e){function i(i,s){function a(){b("beforeInit");e(window).load(function(){u.children("div").addClass("pw-slide");u.children(".pw-slide").children("img").addClass("pw-image");u.children(".pw-slide").children("div").addClass("pw-image-desc");var t=u.width();f();u.find(".pw-slide").on("click",function(){n=e(this);r=n.parent().nextAll(".pw-previewer:first");$oldPreviewer=u.find(".curPreview");$currSlideGroupID=n.attr("data-groupid");$currPreviewerGroupID=-1;if($oldPreviewer.length>0){$currPreviewerGroupID=$oldPreviewer.attr("data-groupid")}if($currSlideGroupID!=$currPreviewerGroupID){u.find(".pw-previewer").addClass("hide").removeClass("curPreview").stop().slideUp(s.speed)}r.empty();r.append("<span class='pw-previewer-close'>x</span>");u.find(".pw-previewer-close").click(function(){v()});e(this).children(".pw-image").clone().appendTo(r);r.children(".pw-image").wrapAll("<div class='pw-image-container' />");e(this).children(".pw-image-desc").clone().appendTo(r);r.slideDown(s.speed,function(){$this=e(this);if(e("body").scrollTop()!=$this.offset().top-s.topOffset){e("html,body").animate({scrollTop:$this.offset().top-s.topOffset},s.speed)}}).removeClass("hide").addClass("curPreview")});e(document).keydown(function(e){switch(e.which){case 27:v();break;case 37:g();break;case 39:m();break;default:return}e.preventDefault()});var i;e(window).resize(function(){if(i){clearTimeout(i)}i=setTimeout(function(){i=null;f()},500)})});b("afterInit")}function f(){u.children(".pw-previewer").remove();if(u.children(".pw-slide-group").length>0){u.find(".pw-slide").unwrap().removeAttr("data-groupid")}var t=u.width();u.append("<div class='pw-tempStore' />");u.children(".pw-tempStore").append(u.contents().not(".pw-tempStore"));var n=1;var r=0;u.append("<div class='pw-slide-group pwsg-"+n+"' />");u.append("<div class='pw-previewer pw-preview-"+n+" hide' data-groupid='"+n+"'></div>");u.children(".pw-tempStore").children(".pw-slide").each(function(){if(r+e(this).width()<=t){u.children(".pwsg-"+n).append(e(this));r+=e(this).width()}else{n++;u.append("<div class='pw-slide-group pwsg-"+n+"' />");u.children(".pwsg-"+n).append(e(this));r=e(this).width();u.append("<div class='pw-previewer pw-preview-"+n+" hide' data-groupid='"+n+"'></div>")}e(this).attr("data-groupid",n)});u.children(".pw-tempStore").remove()}function l(e,t){if(t){s[e]=t}else{return s[e]}}function c(e){u.find(".pw-slide:eq("+e.toString()+")").click()}function h(e){u.find(".pw-slide#"+e.toString()).click()}function p(){u.find(".pw-slide:first").click()}function d(){u.find(".pw-slide:last").click()}function v(){b("beforeClose");n=0;r.empty();r=0;u.find(".pw-previewer").addClass("hide").stop().slideUp(s.speed);b("afterClose")}function m(){b("beforeNext");b("beforeNextPrev");if(n.next().length==0){$nextSlideGroup=n.parent().nextAll(".pw-slide-group:first");if($nextSlideGroup.length==0)u.find(".pw-slide:first").click();else $nextSlideGroup.children(".pw-slide:first").click()}else{n=n.nextAll(".pw-slide:first");r.children(".pw-image-container").empty().append(n.children(".pw-image").clone());r.children(".pw-image-desc").html(n.children(".pw-image-desc").html())}b("afterNext");b("afterNextPrev")}function g(){b("beforePrev");b("beforeNextPrev");if(n.prev().length==0){$prevSlideGroup=n.parent().prevAll(".pw-slide-group:first");if($prevSlideGroup.length==0)u.find(".pw-slide:last").click();else $prevSlideGroup.children(".pw-slide:last").click()}else{n=n.prevAll(".pw-slide:first");r.children(".pw-image-container").empty().append(n.children(".pw-image").clone());r.children(".pw-image-desc").html(n.children(".pw-image-desc").html())}b("afterPrev");b("afterNextPrev")}function y(){u.each(function(){var n=this;var r=e(this);r.children(".pw-previewer").remove();r.find(".pw-slide").unwrap().unbind().removeAttr("data-groupid").removeClass("pw-slide");r.find(".pw-image").removeClass("pw-image");r.find(".pw-image-desc").removeClass("pw-image-desc");b("onDestroy");r.removeData("plugin_"+t)})}function b(e){if(s[e]!==undefined){s[e].call(o)}}var o=i;var u=e(i);s=e.extend({},e.fn.photoWall.defaults,s);a();return{option:l,select:c,selectById:h,selectFirst:p,selectLast:d,close:v,next:m,prev:g,destroy:y}}var t="photoWall";var n=0;var r=0;e.fn.photoWall=function(n){if(typeof arguments[0]==="string"){var r=arguments[0];var s=Array.prototype.slice.call(arguments,1);var o;this.each(function(){if(e.data(this,"plugin_"+t)&&typeof e.data(this,"plugin_"+t)[r]==="function"){o=e.data(this,"plugin_"+t)[r].apply(this,s)}else{throw new Error("Method "+r+" does not exist on jQuery."+t)}});if(o!==undefined){return o}else{return this}}else if(typeof n==="object"||!n){return this.each(function(){if(!e.data(this,"plugin_"+t)){e.data(this,"plugin_"+t,new i(this,n))}})}};e.fn.photoWall.defaults={speed:500,topOffset:30,beforeInit:function(){},afterInit:function(){},beforeNextPrev:function(){},afterNextPrev:function(){},beforeNext:function(){},afterNext:function(){},beforePrev:function(){},afterPrev:function(){},beforeClose:function(){},afterClose:function(){},onDestroy:function(){}}})(jQuery)
